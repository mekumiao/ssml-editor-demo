(function(g,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue"),require("@wangeditor/editor"),require("element-plus"),require("@element-plus/icons-vue")):typeof define=="function"&&define.amd?define(["exports","vue","@wangeditor/editor","element-plus","@element-plus/icons-vue"],o):(g=typeof globalThis<"u"?globalThis:g||self,o(g.SSMLEditor={},g.Vue,g.wangEditor,g.ElementPlus,g.ElementPlusIconsVue))})(this,function(g,o,p,v,Je){"use strict";const Qe={class:"button"},Ye={class:"content"},et=o.defineComponent({__name:"bar-button",props:{text:{},icon:{},disabled:{type:Boolean,default:!1}},emits:["click"],setup(t,{emit:e}){const n=t,r=o.inject("editor"),s=()=>{!n.disabled&&r&&e("click",r==null?void 0:r.value)};return(i,a)=>(o.openBlock(),o.createElementBlock("div",{class:o.normalizeClass(["btn bar-button",{disabled:i.disabled}]),onClick:s,onMousedown:a[0]||(a[0]=o.withModifiers(()=>{},["prevent"]))},[o.createElementVNode("div",Qe,[o.createElementVNode("span",{class:o.normalizeClass(["font-size-30 iconfont-moyin",[`moyin-icon_${i.icon}`]])},null,2)]),o.createElementVNode("div",Ye,o.toDisplayString(i.text),1)],34))}}),Er="",O=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},C=O(et,[["__scopeId","data-v-94376aa5"]]),_r="",xr="",kr="",j=o.defineComponent({__name:"bar-input",props:{type:{}},emits:["submit"],setup(t,{expose:e,emit:n}){const r=o.ref(""),s=o.ref();function i(){s.value.focus()}function a(){n("submit",r.value),r.value=""}return e({focus:i}),(d,f)=>(o.openBlock(),o.createBlock(o.unref(v.ElForm),{class:"flex flex-row",onSubmit:o.withModifiers(a,["prevent"])},{default:o.withCtx(()=>[o.createVNode(o.unref(v.ElInput),{type:d.type,ref_key:"inputRef",ref:s,modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=l=>r.value=l)},null,8,["type","modelValue"])]),_:1},8,["onSubmit"]))}}),Cr="",Dr="",ee=o.defineComponent({__name:"bar-popover",props:{visible:{type:Boolean},trigger:{},hideAfter:{},width:{}},emits:["update:visible"],setup(t){return(e,n)=>(o.openBlock(),o.createBlock(o.unref(v.ElPopover),{hideAfter:e.hideAfter,width:e.width,visible:e.visible,trigger:e.trigger,"onUpdate:visible":n[0]||(n[0]=r=>e.$emit("update:visible",r))},{reference:o.withCtx(()=>[o.renderSlot(e.$slots,"reference")]),default:o.withCtx(()=>[o.renderSlot(e.$slots,"default")]),_:3},8,["hideAfter","width","visible","trigger"]))}}),Vr="",Nr="",Mr="",Tr="",Or="",Ir="",Br="",Lr="",Ar="",A=t=>(o.pushScopeId("data-v-889b5093"),t=t(),o.popScopeId(),t),tt={class:"search-content"},nt={class:"menu"},rt=A(()=>o.createElementVNode("div",{class:"h h-1"},null,-1)),ot={class:"flex flex-row"},st=A(()=>o.createElementVNode("div",{class:"h-1"},null,-1)),it={class:"content flex flex-col"},at=["onClick"],lt=A(()=>o.createElementVNode("div",{class:"w-2"},null,-1)),ut=A(()=>o.createElementVNode("span",{class:"iconfont icon-play"},null,-1)),ct=A(()=>o.createElementVNode("div",{class:"w-1"},null,-1)),ft=o.defineComponent({__name:"search-content",props:{menuItemLabel:{},scenes:{},styles:{},dataList:{}},emits:["submit","fetch"],setup(t,{emit:e}){const n=o.ref(""),r=o.ref(""),s=o.ref(""),i=o.ref("first");function a(){e("fetch",{search:n.value,menuKey:i.value,scene:r.value,style:s.value})}function d(l){i.value=l,a()}function f(l){e("submit",l)}return(l,u)=>(o.openBlock(),o.createElementBlock("div",tt,[o.createVNode(o.unref(v.ElForm),{onSubmit:o.withModifiers(a,["prevent"])},{default:o.withCtx(()=>[o.createVNode(o.unref(v.ElInput),{placeholder:"搜索",modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=c=>n.value=c),"suffix-icon":o.unref(Je.Search)},null,8,["modelValue","suffix-icon"])]),_:1},8,["onSubmit"]),o.createElementVNode("div",nt,[o.createVNode(o.unref(v.ElMenu),{mode:"horizontal","default-active":"first",onSelect:u[1]||(u[1]=c=>d(c))},{default:o.withCtx(()=>[o.createVNode(o.unref(v.ElMenuItem),{index:"first"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(l.menuItemLabel.first),1)]),_:1}),o.createVNode(o.unref(v.ElMenuItem),{index:"second"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(l.menuItemLabel.second),1)]),_:1}),o.createVNode(o.unref(v.ElMenuItem),{index:"last"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(l.menuItemLabel.last),1)]),_:1})]),_:1})]),rt,o.createElementVNode("div",ot,[o.createVNode(o.unref(v.ElSelect),{modelValue:r.value,"onUpdate:modelValue":u[2]||(u[2]=c=>r.value=c),onChange:a,class:"m m-2",size:"large"},{default:o.withCtx(()=>[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(l.scenes,c=>(o.openBlock(),o.createBlock(o.unref(v.ElOption),{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o.createVNode(o.unref(v.ElSelect),{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=c=>s.value=c),onChange:a,class:"m m-2",size:"large"},{default:o.withCtx(()=>[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(l.styles,c=>(o.openBlock(),o.createBlock(o.unref(v.ElOption),{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),st,o.createElementVNode("div",it,[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(l.dataList,(c,m)=>(o.openBlock(),o.createElementBlock("div",{onClick:y=>f(c),class:"btn full p-4 item",key:m},[lt,ut,ct,o.createElementVNode("div",null,o.toDisplayString(c.label),1)],8,at))),128))])]))}}),Fr="",R=O(ft,[["__scopeId","data-v-889b5093"]]),jr="";function dt(t,e){let n,r,s;const i=o.ref(!0),a=()=>{i.value=!0,s()};o.watch(t,a,{flush:"sync"});const d=typeof e=="function"?e:e.get,f=typeof e=="function"?void 0:e.set,l=o.customRef((u,c)=>(r=u,s=c,{get(){return i.value&&(n=d(),i.value=!1),r(),n},set(m){f==null||f(m)}}));return Object.isExtensible(l)&&(l.trigger=a),l}function te(t){return o.getCurrentScope()?(o.onScopeDispose(t),!0):!1}function q(t){return typeof t=="function"?t():o.unref(t)}const pt=typeof window<"u",mt=()=>{};function ne(t,e=!0){o.getCurrentInstance()?o.onMounted(t):e?t():o.nextTick(t)}function I(t){var e;const n=q(t);return(e=n==null?void 0:n.$el)!=null?e:n}const re=pt?window:void 0;function oe(...t){let e,n,r,s;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,r,s]=t,e=re):[e,n,r,s]=t,!e)return mt;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const i=[],a=()=>{i.forEach(u=>u()),i.length=0},d=(u,c,m,y)=>(u.addEventListener(c,m,y),()=>u.removeEventListener(c,m,y)),f=o.watch(()=>[I(e),q(s)],([u,c])=>{a(),u&&i.push(...n.flatMap(m=>r.map(y=>d(u,m,y,c))))},{immediate:!0,flush:"post"}),l=()=>{f(),a()};return te(l),l}function ht(){const t=o.ref(!1);return o.getCurrentInstance()&&o.onMounted(()=>{t.value=!0}),t}function gt(t){const e=ht();return o.computed(()=>(e.value,!!t()))}function bt(){const t=o.getCurrentInstance(),e=dt(()=>null,()=>t.proxy.$el);return o.onUpdated(e.trigger),o.onMounted(e.trigger),e}var se=Object.getOwnPropertySymbols,yt=Object.prototype.hasOwnProperty,vt=Object.prototype.propertyIsEnumerable,wt=(t,e)=>{var n={};for(var r in t)yt.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&se)for(var r of se(t))e.indexOf(r)<0&&vt.call(t,r)&&(n[r]=t[r]);return n};function St(t,e,n={}){const r=n,{window:s=re}=r,i=wt(r,["window"]);let a;const d=gt(()=>s&&"ResizeObserver"in s),f=()=>{a&&(a.disconnect(),a=void 0)},l=o.computed(()=>Array.isArray(t)?t.map(m=>I(m)):[I(t)]),u=o.watch(l,m=>{if(f(),d.value&&s){a=new ResizeObserver(e);for(const y of m)y&&a.observe(y,i)}},{immediate:!0,flush:"post",deep:!0}),c=()=>{f(),u()};return te(c),{isSupported:d,stop:c}}function Et(t,e={}){const{reset:n=!0,windowResize:r=!0,windowScroll:s=!0,immediate:i=!0}=e,a=o.ref(0),d=o.ref(0),f=o.ref(0),l=o.ref(0),u=o.ref(0),c=o.ref(0),m=o.ref(0),y=o.ref(0);function w(){const _=I(t);if(!_){n&&(a.value=0,d.value=0,f.value=0,l.value=0,u.value=0,c.value=0,m.value=0,y.value=0);return}const S=_.getBoundingClientRect();a.value=S.height,d.value=S.bottom,f.value=S.left,l.value=S.right,u.value=S.top,c.value=S.width,m.value=S.x,y.value=S.y}return St(t,w),o.watch(()=>I(t),_=>!_&&w()),s&&oe("scroll",w,{capture:!0,passive:!0}),r&&oe("resize",w,{passive:!0}),ne(()=>{i&&w()}),{height:a,bottom:d,left:f,right:l,top:u,width:c,x:m,y,update:w}}function _t(t=bt()){const e=o.shallowRef(),n=()=>{const r=I(t);r&&(e.value=r.parentElement)};return ne(n),o.watch(()=>q(t),n),e}const xt={class:"content"},kt=o.defineComponent({__name:"top-panel",setup(t,{expose:e}){const n=o.ref(!1),r=_t(),{top:s,left:i}=Et(r),a=o.computed(()=>`top:${s.value}px;left:${i.value}px`);function d(){n.value=!0}function f(){n.value=!1}return e({show:d,hide:f}),(l,u)=>o.withDirectives((o.openBlock(),o.createElementBlock("div",{class:"panel",style:o.normalizeStyle(a.value)},[o.createVNode(o.unref(v.ElCard),null,{default:o.withCtx(()=>[o.createElementVNode("div",xt,[o.renderSlot(l.$slots,"default",{},void 0,!0)])]),_:3})],4)),[[o.vShow,n.value]])}}),Rr="",ie=O(kt,[["__scopeId","data-v-298dc86b"]]),Ct={},Dt={class:"content"};function Vt(t,e){return o.openBlock(),o.createElementBlock("div",Dt)}const ae=O(Ct,[["render",Vt]]),Nt={},Mt={class:"bar-wrapper-item"};function Tt(t,e){return o.openBlock(),o.createElementBlock("div",Mt,[o.renderSlot(t.$slots,"default")])}const le=O(Nt,[["render",Tt]]),Ot={class:"bar-wrapper-group"},It={class:"group-items"},Bt=o.defineComponent({__name:"bar-wrapper-group",props:{divider:{default:"green"}},setup(t){return(e,n)=>(o.openBlock(),o.createElementBlock("div",Ot,[o.createElementVNode("div",{class:o.normalizeClass(["divider",[e.divider]])},null,2),o.createElementVNode("div",It,[o.renderSlot(e.$slots,"default",{},void 0,!0)])]))}}),Pr="",ue=O(Bt,[["__scopeId","data-v-74379d98"]]),Lt={install(t){t.component("BarButton",C),t.component("BarInput",j),t.component("BarPopover",ee),t.component("BarSearch",R),t.component("TopPanel",ie),t.component("BarWrapper",ae),t.component("BarWrapperItem",le),t.component("BarWrapperGroup",ue)}};let At=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");function D(t="r"){return`${t}-${At()}`}var P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ft(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ce="Expected a function",fe=0/0,jt="[object Symbol]",Rt=/^\s+|\s+$/g,Pt=/^[-+]0x[0-9a-f]+$/i,Wt=/^0b[01]+$/i,$t=/^0o[0-7]+$/i,Ht=parseInt,Ut=typeof P=="object"&&P&&P.Object===Object&&P,qt=typeof self=="object"&&self&&self.Object===Object&&self,zt=Ut||qt||Function("return this")(),Gt=Object.prototype,Kt=Gt.toString,Xt=Math.max,Zt=Math.min,z=function(){return zt.Date.now()};function Jt(t,e,n){var r,s,i,a,d,f,l=0,u=!1,c=!1,m=!0;if(typeof t!="function")throw new TypeError(ce);e=de(e)||0,W(n)&&(u=!!n.leading,c="maxWait"in n,i=c?Xt(de(n.maxWait)||0,e):i,m="trailing"in n?!!n.trailing:m);function y(E){var M=r,F=s;return r=s=void 0,l=E,a=t.apply(F,M),a}function w(E){return l=E,d=setTimeout(N,e),u?y(E):a}function _(E){var M=E-f,F=E-l,Ze=e-M;return c?Zt(Ze,i-F):Ze}function S(E){var M=E-f,F=E-l;return f===void 0||M>=e||M<0||c&&F>=i}function N(){var E=z();if(S(E))return B(E);d=setTimeout(N,_(E))}function B(E){return d=void 0,m&&r?y(E):(r=s=void 0,a)}function L(){d!==void 0&&clearTimeout(d),l=0,r=f=s=d=void 0}function Sr(){return d===void 0?a:B(z())}function Y(){var E=z(),M=S(E);if(r=arguments,s=this,f=E,M){if(d===void 0)return w(f);if(c)return d=setTimeout(N,e),y(f)}return d===void 0&&(d=setTimeout(N,e)),a}return Y.cancel=L,Y.flush=Sr,Y}function Qt(t,e,n){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(ce);return W(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),Jt(t,e,{leading:r,maxWait:e,trailing:s})}function W(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Yt(t){return!!t&&typeof t=="object"}function en(t){return typeof t=="symbol"||Yt(t)&&Kt.call(t)==jt}function de(t){if(typeof t=="number")return t;if(en(t))return fe;if(W(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=W(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Rt,"");var n=Wt.test(t);return n||$t.test(t)?Ht(t.slice(2),n?2:8):Pt.test(t)?fe:+t}var tn=Qt;const nn=Ft(tn);function pe(t){return t!==null&&typeof t=="object"&&"constructor"in t&&t.constructor===Object}function G(t,e){t===void 0&&(t={}),e===void 0&&(e={}),Object.keys(e).forEach(function(n){typeof t[n]>"u"?t[n]=e[n]:pe(e[n])&&pe(t[n])&&Object.keys(e[n]).length>0&&G(t[n],e[n])})}var me={body:{},addEventListener:function(){},removeEventListener:function(){},activeElement:{blur:function(){},nodeName:""},querySelector:function(){return null},querySelectorAll:function(){return[]},getElementById:function(){return null},createEvent:function(){return{initEvent:function(){}}},createElement:function(){return{children:[],childNodes:[],style:{},setAttribute:function(){},getElementsByTagName:function(){return[]}}},createElementNS:function(){return{}},importNode:function(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function K(){var t=typeof document<"u"?document:{};return G(t,me),t}var rn={document:me,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState:function(){},pushState:function(){},go:function(){},back:function(){}},CustomEvent:function(){return this},addEventListener:function(){},removeEventListener:function(){},getComputedStyle:function(){return{getPropertyValue:function(){return""}}},Image:function(){},Date:function(){},screen:{},setTimeout:function(){},clearTimeout:function(){},matchMedia:function(){return{}},requestAnimationFrame:function(t){return typeof setTimeout>"u"?(t(),null):setTimeout(t,0)},cancelAnimationFrame:function(t){typeof setTimeout>"u"||clearTimeout(t)}};function he(){var t=typeof window<"u"?window:{};return G(t,rn),t}function on(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function X(t){return X=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},X(t)}function $(t,e){return $=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},$(t,e)}function sn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function H(t,e,n){return sn()?H=Reflect.construct:H=function(s,i,a){var d=[null];d.push.apply(d,i);var f=Function.bind.apply(s,d),l=new f;return a&&$(l,a.prototype),l},H.apply(null,arguments)}function an(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Z(t){var e=typeof Map=="function"?new Map:void 0;return Z=function(r){if(r===null||!an(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(r))return e.get(r);e.set(r,s)}function s(){return H(r,arguments,X(this).constructor)}return s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),$(s,r)},Z(t)}function ln(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function un(t){var e=t.__proto__;Object.defineProperty(t,"__proto__",{get:function(){return e},set:function(r){e.__proto__=r}})}var T=function(t){on(e,t);function e(n){var r;return r=t.call.apply(t,[this].concat(n))||this,un(ln(r)),r}return e}(Z(Array));function J(t){t===void 0&&(t=[]);var e=[];return t.forEach(function(n){Array.isArray(n)?e.push.apply(e,J(n)):e.push(n)}),e}function cn(t){for(var e=[],n=0;n<t.length;n+=1)e.indexOf(t[n])===-1&&e.push(t[n]);return e}function fn(t){return t.toLowerCase().replace(/-(.)/g,function(e,n){return n.toUpperCase()})}function dn(t,e){if(typeof t!="string")return[t];for(var n=[],r=e.querySelectorAll(t),s=0;s<r.length;s+=1)n.push(r[s]);return n}function b(t,e){var n=he(),r=K(),s=[];if(!e&&t instanceof T)return t;if(!t)return new T(s);if(typeof t=="string"){var i=t.trim();if(i.indexOf("<")>=0&&i.indexOf(">")>=0){var a="div";i.indexOf("<li")===0&&(a="ul"),i.indexOf("<tr")===0&&(a="tbody"),(i.indexOf("<td")===0||i.indexOf("<th")===0)&&(a="tr"),i.indexOf("<tbody")===0&&(a="table"),i.indexOf("<option")===0&&(a="select");var d=r.createElement(a);d.innerHTML=i;for(var f=0;f<d.childNodes.length;f+=1)s.push(d.childNodes[f])}else s=dn(t.trim(),e||r)}else if(t.nodeType||t===n||t===r)s.push(t);else if(Array.isArray(t)){if(t instanceof T)return t;s=t}return new T(cn(s))}b.fn=T.prototype;function ge(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=J(e.map(function(s){return s.split(" ")}));return this.forEach(function(s){var i;(i=s.classList).add.apply(i,r)}),this}function be(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=J(e.map(function(s){return s.split(" ")}));return this.forEach(function(s){var i;(i=s.classList).remove.apply(i,r)}),this}function ye(t,e){if(arguments.length===1&&typeof t=="string")return this[0]?this[0].getAttribute(t):void 0;for(var n=0;n<this.length;n+=1)if(arguments.length===2)this[n].setAttribute(t,e);else for(var r in t)this[n][r]=t[r],this[n].setAttribute(r,t[r]);return this}function ve(){var t=this[0];if(t){var e={};if(t.dataset)for(var n in t.dataset)e[n]=t.dataset[n];else for(var r=0;r<t.attributes.length;r+=1){var s=t.attributes[r];s.name.indexOf("data-")>=0&&(e[fn(s.name.split("data-")[1])]=s.value)}for(var i in e)e[i]==="false"?e[i]=!1:e[i]==="true"?e[i]=!0:parseFloat(e[i])===e[i]*1&&(e[i]*=1);return e}}function we(t){if(typeof t>"u"){var e=this[0];if(!e)return;if(e.multiple&&e.nodeName.toLowerCase()==="select"){for(var n=[],r=0;r<e.selectedOptions.length;r+=1)n.push(e.selectedOptions[r].value);return n}return e.value}for(var s=0;s<this.length;s+=1){var i=this[s];if(Array.isArray(t)&&i.multiple&&i.nodeName.toLowerCase()==="select")for(var a=0;a<i.options.length;a+=1)i.options[a].selected=t.indexOf(i.options[a].value)>=0;else i.value=t}return this}function Se(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],s=e[1],i=e[2],a=e[3];typeof e[1]=="function"&&(r=e[0],i=e[1],a=e[2],s=void 0),a||(a=!1);function d(_){var S=_.target;if(S){var N=_.target.dom7EventData||[];if(N.indexOf(_)<0&&N.unshift(_),b(S).is(s))i.apply(S,N);else for(var B=b(S).parents(),L=0;L<B.length;L+=1)b(B[L]).is(s)&&i.apply(B[L],N)}}function f(_){var S=_&&_.target?_.target.dom7EventData||[]:[];S.indexOf(_)<0&&S.unshift(_),i.apply(this,S)}for(var l=r.split(" "),u,c=0;c<this.length;c+=1){var m=this[c];if(s)for(u=0;u<l.length;u+=1){var w=l[u];m.dom7LiveListeners||(m.dom7LiveListeners={}),m.dom7LiveListeners[w]||(m.dom7LiveListeners[w]=[]),m.dom7LiveListeners[w].push({listener:i,proxyListener:d}),m.addEventListener(w,d,a)}else for(u=0;u<l.length;u+=1){var y=l[u];m.dom7Listeners||(m.dom7Listeners={}),m.dom7Listeners[y]||(m.dom7Listeners[y]=[]),m.dom7Listeners[y].push({listener:i,proxyListener:f}),m.addEventListener(y,f,a)}}return this}function Ee(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],s=e[1],i=e[2],a=e[3];typeof e[1]=="function"&&(r=e[0],i=e[1],a=e[2],s=void 0),a||(a=!1);for(var d=r.split(" "),f=0;f<d.length;f+=1)for(var l=d[f],u=0;u<this.length;u+=1){var c=this[u],m=void 0;if(!s&&c.dom7Listeners?m=c.dom7Listeners[l]:s&&c.dom7LiveListeners&&(m=c.dom7LiveListeners[l]),m&&m.length)for(var y=m.length-1;y>=0;y-=1){var w=m[y];i&&w.listener===i||i&&w.listener&&w.listener.dom7proxy&&w.listener.dom7proxy===i?(c.removeEventListener(l,w.proxyListener,a),m.splice(y,1)):i||(c.removeEventListener(l,w.proxyListener,a),m.splice(y,1))}}return this}function _e(){for(var t=0;t<this.length;t+=1)this[t].style.display="none";return this}function xe(t){return t?(this.forEach(function(e,n){t.apply(e,[e,n])}),this):this}function ke(t){if(typeof t>"u")return this[0]?this[0].innerHTML:null;for(var e=0;e<this.length;e+=1)this[e].innerHTML=t;return this}function Ce(t){var e=he(),n=K(),r=this[0],s,i;if(!r||typeof t>"u")return!1;if(typeof t=="string"){if(r.matches)return r.matches(t);if(r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(r.msMatchesSelector)return r.msMatchesSelector(t);for(s=b(t),i=0;i<s.length;i+=1)if(s[i]===r)return!0;return!1}if(t===n)return r===n;if(t===e)return r===e;if(t.nodeType||t instanceof T){for(s=t.nodeType?[t]:t,i=0;i<s.length;i+=1)if(s[i]===r)return!0;return!1}return!1}function De(){for(var t,e=K(),n=0;n<arguments.length;n+=1){t=n<0||arguments.length<=n?void 0:arguments[n];for(var r=0;r<this.length;r+=1)if(typeof t=="string"){var s=e.createElement("div");for(s.innerHTML=t;s.firstChild;)this[r].appendChild(s.firstChild)}else if(t instanceof T)for(var i=0;i<t.length;i+=1)this[r].appendChild(t[i]);else this[r].appendChild(t)}return this}function Ve(t){for(var e=[],n=0;n<this.length;n+=1)for(var r=this[n].parentNode;r;)t?b(r).is(t)&&e.push(r):e.push(r),r=r.parentNode;return b(e)}function Ne(t){for(var e=[],n=0;n<this.length;n+=1)for(var r=this[n].querySelectorAll(t),s=0;s<r.length;s+=1)e.push(r[s]);return b(e)}function Me(t){for(var e=[],n=0;n<this.length;n+=1)for(var r=this[n].children,s=0;s<r.length;s+=1)(!t||b(r[s]).is(t))&&e.push(r[s]);return b(e)}var pn="resize scroll".split(" ");function Te(t){function e(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];if(typeof r[0]>"u"){for(var i=0;i<this.length;i+=1)pn.indexOf(t)<0&&(t in this[i]?this[i][t]():b(this[i]).trigger(t));return this}return this.on.apply(this,[t].concat(r))}return e}var Oe=Te("click"),Ie=Te("focus");_e&&(b.fn.hide=_e),De&&(b.fn.append=De),Oe&&(b.fn.click=Oe),Se&&(b.fn.on=Se),Ee&&(b.fn.off=Ee),Ie&&(b.fn.focus=Ie),ye&&(b.fn.attr=ye),we&&(b.fn.val=we),ke&&(b.fn.html=ke),ve&&(b.fn.dataset=ve),ge&&(b.fn.addClass=ge),be&&(b.fn.removeClass=be),Me&&(b.fn.children=Me),xe&&(b.fn.each=xe),Ne&&(b.fn.find=Ne),Ce&&(b.fn.is=Ce),Ve&&(b.fn.parents=Ve);const mn=globalThis.Node,hn=globalThis.Comment,gn=globalThis.Element,bn=globalThis.Text,yn=globalThis.Range,vn=globalThis.Selection,wn=globalThis.StaticRange;function Be(t,e,n,r,s){b("body").on("click",`#${r}-${e}`,nn(i=>{i.preventDefault();const a=En(t,n,r);return a&&s(a)}))}function V(t,e,n,r){return Be(t,"close",e,n,r)}function Sn(t,e,n,r){return Be(t,"play",e,n,r)}function En(t,e,n){const[r]=p.SlateEditor.nodes(t,{at:[],match:s=>!p.SlateElement.isElement(s)||!p.DomEditor.checkNodeType(s,e)?!1:s.domId===n});return r}function U(t,e,n){const r=p.SlateEditor.previous(t,{at:e[1],match:s=>p.SlateText.isText(s)});r!=null&&(p.SlateTransforms.insertText(t,n(e[0]),{at:p.SlateEditor.end(t,r[1])}),p.SlateTransforms.delete(t,{at:p.SlatePath.next(r[1])}))}function _n(){return D("w-e-dom-speaker")}let xn=class{getValue(e){const{selection:n}=e;return n==null?null:p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;if(n==null||p.SlateRange.isCollapsed(n))return!0;const r=p.SlateEditor.string(e,n);return r.length!=1||!/^[\u4E00-\u9FA5]+$/gi.test(r)}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s=this.getValue(e);if(s==null)return;const i={type:"ssml-p",domId:_n(),word:s,phoneme:n,remark:n,bgColor:"speaker",children:[{text:""}]};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,i),e.move(1),V(e,"ssml-p",i.domId,a=>{U(e,a,d=>d.word)})}};function kn(t){const e={我:[{id:"1",text:"wo1",remark:"wo1"},{id:"2",text:"wo2",remark:"wo2"},{id:"3",text:"wo3",remark:"wo3"}],的:[{id:"1",text:"de1",remark:"de1"},{id:"2",text:"de2",remark:"de2"},{id:"3",text:"de3",remark:"de3"}]};return Promise.resolve(e[t]||e.我)}const Le=o.defineComponent({emits:["error"],props:["fetch"],setup(t,{emit:e}){const n=new xn,r=o.inject("editor"),s=o.ref([]),i=o.ref(!1);function a(){i.value||(i.value=!0)}function d(){i.value&&(i.value=!1)}async function f(l){const u=n.getValue(l);if(u?s.value=await(t.fetch||kn)(u):s.value=[],n.isDisabled(l))return e("error","选中一个中文字符，并且有不能在其他语句之内");if(s.value.length==0)return e("error","选中的字符没有不是多音字");a()}return()=>o.createVNode(v.ElPopover,{visible:i.value,"onUpdate:visible":l=>i.value=l,trigger:"contextmenu",hideAfter:0},{reference:()=>o.createVNode(C,{text:"多音字",icon:"speaker",onClick:f},null),default:()=>o.createVNode("div",{class:"flex flex-col"},[s.value.map(({id:l,text:u})=>o.createVNode("div",{key:l,class:"btn full",onClick:()=>{n.isDisabled(r==null?void 0:r.value)||n.exec(r==null?void 0:r.value,u),d()},onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[u]))])})}});function Cn(){return D("w-e-dom-continuous")}class Dn{getValue(e){const{selection:n}=e;return n==null?"":p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;return!!(n==null||p.SlateRange.isCollapsed(n)||p.SlateEditor.string(e,n).length<2)}exec(e){if(this.isDisabled(e))return;const{selection:n}=e;if(n==null)return;const r=this.getValue(e);if(r==null)return;const s={type:"ssml-w",domId:Cn(),children:[{text:r}],remark:"连读",bgColor:"continuous"};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,s),V(e,"ssml-w",s.domId,i=>{p.SlateTransforms.unwrapNodes(e,{at:i[1]})})}}const Ae=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new Dn;function r(s){if(n.isDisabled(s))return e("error","请选择多个中文字符或者多个多个英文单词");n.exec(s)}return()=>o.createVNode(C,{text:"连读",icon:"continuous",onClick:r},null)}});function Vn(){return D("w-e-dom-read")}class Nn{getValue(e){const{selection:n}=e;return n==null?"":p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;return!!(n==null||p.SlateRange.isCollapsed(n)||p.SlateEditor.string(e,n).length<=0)}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s=this.getValue(e);if(s==null)return;const i={type:"ssml-w",domId:Vn(),phoneme:n.id,remark:n.remark,value:s,bgColor:"read",children:[{text:s}]};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,i),V(e,"ssml-w",i.domId,a=>U(e,a,()=>s))}}const Mn=[{id:"z",text:"重音",remark:"重"},{id:"t",text:"拖音",remark:"拖"},{id:"all",text:"重音+拖音",remark:"重+拖"}],Fe=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new Nn,r=o.inject("editor"),s=o.ref(!1);function i(){s.value||(s.value=!0)}function a(){s.value&&(s.value=!1)}function d(f){if(n.isDisabled(f)){e("error","请先选择文本");return}i()}return()=>o.createVNode(v.ElPopover,{visible:s.value,"onUpdate:visible":f=>s.value=f,trigger:"contextmenu",hideAfter:0},{reference:()=>o.createVNode(C,{text:"重音",icon:"read",onClick:d},null),default:()=>o.createVNode("div",{class:"flex flex-col",onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[Mn.map(({id:f,text:l,remark:u})=>o.createVNode("div",{key:f,class:"btn full",onClick:()=>{n.isDisabled(r==null?void 0:r.value)||n.exec(r==null?void 0:r.value,{id:f,text:l,remark:u}),a()},onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[l]))])})}});function Tn(){return D("w-e-dom-digital")}class On{getValue(e){const{selection:n}=e;return n==null?"":p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;if(n==null||p.SlateRange.isCollapsed(n))return!0;const r=p.SlateEditor.string(e,n);return!!(r.length<=0||Number.isNaN(Number(r)))}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s=this.getValue(e);if(s==null)return;const i={type:"ssml-say-as",domId:Tn(),interpretAs:n.id,remark:n.remark,bgColor:"digital",children:[{text:s}]};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,i),V(e,"ssml-say-as",i.domId,a=>{p.SlateTransforms.unwrapNodes(e,{at:a[1]})})}}const In=[{id:"value",text:"读数值",remark:"读数值"},{id:"digits",text:"读数字",remark:"读数字"},{id:"telephone",text:"读手机号",remark:"读手机号"}],je=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new On,r=o.inject("editor"),s=o.ref(!1);function i(){s.value=!s.value}function a(d){if(n.isDisabled(d)){e("error","请选择纯数字文本");return}i()}return()=>o.createVNode(v.ElPopover,{visible:s.value,"onUpdate:visible":d=>s.value=d,trigger:"contextmenu",hideAfter:0},{reference:()=>o.createVNode(C,{text:"数字符号",icon:"digital",onClick:a},null),default:()=>o.createVNode("div",{class:"flex flex-col"},[In.map(({id:d,text:f,remark:l})=>o.createVNode("div",{key:d,class:"btn radius ssml-menu item full",onClick:()=>{n.isDisabled(r==null?void 0:r.value)||n.exec(r==null?void 0:r.value,{id:d,text:f,remark:l}),i()},onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[f]))])})}});function Bn(){return D("w-e-dom-alias")}class Ln{getValue(e){const{selection:n}=e;return n==null?null:p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;return!!(n==null||p.SlateRange.isCollapsed(n)||p.SlateEditor.string(e,n).length<=0)}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s=this.getValue(e);if(s==null)return;const i={type:"ssml-sub",domId:Bn(),remark:`(${n})`,alias:n,value:s,bgColor:"alias",children:[{text:""}]};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,i),V(e,"ssml-sub",i.domId,a=>U(e,a,d=>d.value))}}const Re=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new Ln,r=o.inject("editor"),s=o.ref(),i=o.ref(!1),a=o.shallowRef();function d(){i.value||(i.value=!0)}function f(){i.value&&(i.value=!1)}async function l(c){if(n.isDisabled(c)){e("error","选中一个中文字符，并且有不能在其他语句之内");return}d(),a.value=c.selection,s.value.focus()}function u(c){f();const m=r==null?void 0:r.value;!m||!c||(m.select(a.value),!n.isDisabled(m)&&n.exec(m,c))}return()=>o.createVNode(v.ElPopover,{visible:i.value,"onUpdate:visible":c=>i.value=c,trigger:"contextmenu",placement:"right-end",hideAfter:0,width:200},{reference:()=>o.createVNode(C,{text:"别名",icon:"alias",onClick:l},null),default:()=>o.createVNode(j,{ref:s,onSubmit:u},null)})}});function An(t){const{selection:e}=t;if(e){const[n,r]=p.SlateRange.edges(e),s=p.SlateEditor.range(t,n,r),i=p.SlateEditor.string(t,s),a=i.trimEnd();if(a!==i){const d=i.length-a.length,f={...r,offset:r.offset-d},l={...e,anchor:n,focus:f};p.SlateTransforms.select(t,l)}}}function Fn(){return D("w-e-dom-english")}class jn{getValue(e){const{selection:n}=e;return n==null?null:p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;if(n==null||p.SlateRange.isCollapsed(n))return!0;const r=p.SlateEditor.string(e,n);return r.length<=0||!/^[A-Za-z]+$/gi.test(r)}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s=this.getValue(e);if(s==null)return;const i={type:"ssml-p",domId:Fn(),word:s,phoneme:n,remark:n,bgColor:"english",children:[{text:""}]};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,i),e.move(1),V(e,"ssml-p",i.domId,a=>U(e,a,d=>d.word))}}function Rn(t){const e={translate:[{id:"1",text:"wərd",remark:"wərd"}],global:[{id:"2",text:"ˈɡlōbəl",remark:"ˈɡlōbəl"}]};return Promise.resolve(e[t]||e.translate)}const Pe=o.defineComponent({emits:["error"],props:["popover","fetch"],setup(t,{emit:e}){const n=new jn,r=o.inject("editor"),s=o.ref([]),i=o.ref(!1);function a(){i.value||(i.value=!0)}function d(){i.value&&(i.value=!1)}async function f(l){if(An(l),n.isDisabled(l))return e("error","请选择英文单词");const u=n.getValue(l);if(u){if(s.value=await(t.fetch||Rn)(u),s.value.length<=0)return e("error","找不到单词的音标");a()}}return()=>o.createVNode(v.ElPopover,{visible:i.value,trigger:"contextmenu",hideAfter:0},{reference:()=>o.createVNode(C,{text:"音标",icon:"english",onClick:f},null),default:()=>o.createVNode("div",{class:"flex flex-col"},[s.value.map(({id:l,text:u})=>o.createVNode("div",{key:l,class:"btn full",onClick:()=>{n.isDisabled(r==null?void 0:r.value)||n.exec(r==null?void 0:r.value,u),d()},onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[u]))])})}});function Pn(){return D("w-e-dom-changespeed")}class Wn{getValue(e){const{selection:n}=e;return n==null?null:p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;return!!(n==null||p.SlateRange.isCollapsed(n)||p.SlateEditor.string(e,n).length<=1)}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s=this.getValue(e);if(s==null)return;const i={type:"ssml-prosody",domId:Pn(),remark:n,rate:n,bgColor:"changespeed",children:[{text:s}]};p.SlateTransforms.delete(e),p.SlateTransforms.insertNodes(e,i),V(e,"ssml-prosody",i.domId,a=>{p.SlateTransforms.unwrapNodes(e,{at:a[1]})})}}function $n(){const t=[];for(let e=2;e<=40;e++){const n=`${(e*.05).toFixed(2)}x`;t.push({id:e.toString(),text:n,remark:n})}return Promise.resolve(t)}const We=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new Wn,r=o.inject("editor"),s=o.ref([]),i=o.ref(!1);function a(){i.value||(i.value=!0)}function d(){i.value&&(i.value=!1)}async function f(l){if(s.value=await $n(),n.isDisabled(l)){e("error","选中一个中文字符，并且有不能在其他语句之内");return}a()}return()=>o.createVNode(v.ElPopover,{style:{padding:"0px"},visible:i.value,"onUpdate:visible":l=>i.value=l,trigger:"contextmenu",hideAfter:0},{reference:()=>o.createVNode(C,{text:"局部变速",icon:"changespeed",onClick:f},null),default:()=>o.createVNode("div",{class:"flex flex-col h h-50 scroll scroll-y"},[s.value.map(({id:l,text:u})=>o.createVNode("div",{key:l,class:"btn full",onClick:()=>{n.isDisabled(r==null?void 0:r.value)||n.exec(r==null?void 0:r.value,u),d()},onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[u]))])})}});function Hn(){return D("w-e-dom-rhythm")}class Un{isDisabled(e){const{selection:n}=e;return!!(n==null||p.SlateRange.isExpanded(n))}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s={type:"ssml-break",domId:Hn(),time:n.id,remark:n.remark,bgColor:"rhythm",children:[{text:""}]};p.SlateTransforms.insertNodes(e,s),e.move(1),V(e,"ssml-break",s.domId,i=>{p.SlateTransforms.delete(e,{at:i[1]})})}}const qn=[{id:"200ms",text:"短",remark:"短"},{id:"300ms",text:"中",remark:"中"},{id:"500ms",text:"长",remark:"长"}],$e=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new Un,r=o.inject("editor"),s=o.ref(!1);function i(){s.value||(s.value=!0)}function a(){s.value&&(s.value=!1)}function d(f){if(n.isDisabled(f)){e("error","不能选择文本");return}i()}return()=>o.createVNode(v.ElPopover,{visible:s.value,"onUpdate:visible":f=>s.value=f,trigger:"contextmenu",hideAfter:0},{reference:()=>o.createVNode(C,{text:"停顿调节",icon:"rhythm",onClick:d},null),default:()=>o.createVNode("div",{class:"flex flex-col"},[qn.map(({id:f,text:l,remark:u})=>o.createVNode("div",{key:f,class:"btn radius ssml-menu item full",onClick:()=>{n.isDisabled(r==null?void 0:r.value)||n.exec(r==null?void 0:r.value,{id:f,text:l,remark:u}),a()},onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[l]))])})}}),Wr="",$r="";function He(t){if(window.navigator.userAgent.toLowerCase().indexOf("ie")>=0){const n=`<embed name="embedPlay" src="${t}"></embed>`;b("body").find("embed").length<=0&&b("body").append(n);const r=document.embedPlay;r.volume=100}else{const n=`<audio id='audioPlay' src='${t}' hidden='true'>`;b("body").find("audio").length<=0&&b("body").append(n),document.getElementById("audioPlay").play()}}function zn(){return D("w-e-dom-special")}class Gn{getValue(e){const{selection:n}=e;return n==null?null:p.SlateEditor.string(e,n)}isDisabled(e){const{selection:n}=e;return n==null||p.SlateRange.isExpanded(n)?!0:p.SlateEditor.string(e,n).length>0}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null||this.getValue(e)==null)return;const i={type:"ssml-audio",domId:zn(),src:n.value,remark:n.label,bgColor:"special",children:[{text:""}]};p.SlateTransforms.insertNodes(e,i),e.move(1),V(e,"ssml-audio",i.domId,a=>p.SlateTransforms.delete(e,{at:a[1]})),Sn(e,"ssml-audio",i.domId,a=>He(a[0].src))}}const Ue=o.defineComponent({emits:["error"],props:{fetch:{type:Function,required:!0},scenes:{type:Object,required:!0},styles:{type:Object,required:!0}},setup(t,{emit:e}){const n=new Gn,r=o.ref(!1),s=o.shallowRef(),i=o.ref([]),a=o.inject("editor");async function d(l){if(n.isDisabled(l)){e("error","请选中编辑区，并且不能选中文字");return}r.value=!0,i.value=await t.fetch({search:"",menuKey:"first",scene:"",style:""}),s.value=l.selection}const f=l=>{r.value=!1;const u=a==null?void 0:a.value;!u||!l||(u.select(s.value),!n.isDisabled(u)&&n.exec(u,l))};return()=>o.createVNode("div",null,[o.createVNode(C,{text:"音效",icon:"special",onClick:d},null),o.createVNode(v.ElDialog,{modelValue:r.value,"onUpdate:modelValue":l=>r.value=l,width:500},{default:()=>[o.createVNode(R,{menuItemLabel:{first:"默认音效",second:"自定义音效",last:"最近音效"},scenes:t.scenes,styles:t.styles,dataList:i.value,onSubmit:f,onFetch:async l=>{const u=await t.fetch(l);i.value=u}},null)]})])}});function Kn(){return D("w-e-dom-mute")}class Xn{isDisabled(e){const{selection:n}=e;return!!(n==null||p.SlateRange.isExpanded(n))}exec(e,n){if(this.isDisabled(e))return;const{selection:r}=e;if(r==null)return;const s={type:"ssml-break",domId:Kn(),time:n,remark:n,bgColor:"mute",children:[{text:""}]};p.SlateTransforms.insertNodes(e,s),e.move(1),V(e,"ssml-break",s.domId,i=>{p.SlateTransforms.delete(e,{at:i[1]})})}}const Zn=[{id:"150ms",text:"150ms",remark:"150ms"},{id:"200ms",text:"200ms",remark:"200ms"},{id:"300ms",text:"300ms",remark:"300ms"},{id:"400ms",text:"400ms",remark:"400ms"},{id:"500ms",text:"500ms",remark:"500ms"},{id:"600ms",text:"600ms",remark:"600ms"}],qe=o.defineComponent({emits:["error"],setup(t,{emit:e}){const n=new Xn,r=o.inject("editor");r||e("error","请注入editor");const s=o.ref(!1),i=o.ref(),a=o.shallowRef();function d(){s.value||(s.value=!0)}function f(){s.value&&(s.value=!1)}function l(c){if(n.isDisabled(c)){e("error","不能选择文本");return}d(),a.value=c.selection,i.value.focus()}function u(c){f();const m=r==null?void 0:r.value;!m||!c||(m.select(a.value),!n.isDisabled(m)&&n.exec(m,c))}return()=>o.createVNode(v.ElPopover,{visible:s.value,"onUpdate:visible":c=>s.value=c,trigger:"contextmenu",hideAfter:0,width:200},{reference:()=>o.createVNode(C,{text:"插入静音",icon:"mute",onClick:l},null),default:()=>o.createVNode("div",{class:"flex flex-col"},[Zn.map(({id:c,text:m})=>o.createVNode("div",{key:c,class:"btn radius ssml-menu item full",onClick:()=>u(c),onMousedown:o.withModifiers(()=>{},["stop","prevent"])},[m])),o.createVNode(j,{type:"number",ref:i,onSubmit:u},null)])})}}),ze=o.defineComponent({emits:["error"],props:{fetch:{type:Function,required:!0},scenes:{type:Object,required:!0},styles:{type:Object,required:!0}},setup(t,{emit:e}){const n=o.ref(!1),r=o.shallowRef(),s=o.ref([]),i=o.inject("editor");async function a(f){n.value=!0,s.value=await t.fetch({search:"",menuKey:"first",scene:"",style:""}),r.value=f.selection}const d=f=>{n.value=!1;const l=i==null?void 0:i.value;if(!l||!f){e("error","背景音乐值无效");return}l.emit("updateBgm",f)};return()=>o.createVNode("div",null,[o.createVNode(C,{text:"配乐",icon:"bgm",onClick:a},null),o.createVNode(v.ElDialog,{modelValue:n.value,"onUpdate:modelValue":f=>n.value=f,width:500},{default:()=>[o.createVNode(R,{menuItemLabel:{first:"默认配乐",second:"自定义配乐",last:"最近配乐"},scenes:t.scenes,styles:t.styles,dataList:s.value,onSubmit:d,onFetch:async f=>{const l=await t.fetch(f);s.value=l}},null)]})])}}),Hr="",Jn={install:t=>{t.component("SpeakerMenu",Le),t.component("ContinuousMenu",Ae),t.component("ReadMenu",Fe),t.component("DigitalMenu",je),t.component("AliasMenu",Re),t.component("EnglishMenu",Pe),t.component("ChangespeedMenu",We),t.component("RhythmMenu",$e),t.component("SpecialMenu",Ue),t.component("MuteMenu",qe),t.component("BgmMenu",ze)}};function Ge(t,e,n,r,s){const i=e===void 0?void 0:e.key;return{sel:t,data:e,children:n,text:r,elm:s,key:i}}const Ke=Array.isArray;function Q(t){return typeof t=="string"||typeof t=="number"||t instanceof String||t instanceof Number}function Xe(t,e,n){if(t.ns="http://www.w3.org/2000/svg",n!=="foreignObject"&&e!==void 0)for(let r=0;r<e.length;++r){const s=e[r];if(typeof s=="string")continue;const i=s.data;i!==void 0&&Xe(i,s.children,s.sel)}}function h(t,e,n){let r={},s,i,a;if(n!==void 0?(e!==null&&(r=e),Ke(n)?s=n:Q(n)?i=n.toString():n&&n.sel&&(s=[n])):e!=null&&(Ke(e)?s=e:Q(e)?i=e.toString():e&&e.sel?s=[e]:r=e),s!==void 0)for(a=0;a<s.length;++a)Q(s[a])&&(s[a]=Ge(void 0,void 0,void 0,s[a],void 0));return t[0]==="s"&&t[1]==="v"&&t[2]==="g"&&(t.length===3||t[3]==="."||t[3]==="#")&&Xe(r,s,t),Ge(t,r,s,i,void 0)}const x={style:{userSelect:"none"},contentEditable:!1};function Qn(t){const{domId:e,bgColor:n,remark:r,word:s}=t;return h("span.ssml-wrap",{...x},[h(`span.tag.bg-color.${n}`,[h("span.tag-remark",{attrs:{"data-tag-remark":r}}),h(`span#${e}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill",null))]),h(`span.boundary.start.ft-color.${n}`),h("span",s),h(`span.boundary.end.ft-color.${n}`)])}function Yn(t,e){const{bgColor:n,domId:r,remark:s,value:i}=t;return h("span.ssml-wrap",e?{}:{...x},[h(`span.tag.bg-color.${n}`,{...x},[h("span.tag-remark",{attrs:{"data-tag-remark":s}}),h(`span#${r}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill",null))]),h(`span.boundary.start.ft-color.${n}`,{...x}),h("span",e||i),h(`span.boundary.end.ft-color.${n}`,{...x})])}function er(t,e){const{bgColor:n,domId:r,remark:s}=t;return h("span.ssml-wrap",[h(`span.tag.bg-color.${n}`,{...x},[h("span.tag-remark",{attrs:{"data-tag-remark":s}}),h(`span#${r}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill",null))]),h(`span.boundary.start.ft-color.${n}`,{...x}),h("span",e),h(`span.boundary.end.ft-color.${n}`,{...x})])}function tr(t){const{domId:e,remark:n,bgColor:r}=t;return h("span.ssml-wrap",[h(`span.tag.bg-color.${r}`,{...x},[h("span.tag-remark",{attrs:{"data-tag-remark":n}}),h(`span#${e}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill",null))])])}function nr(t){const{domId:e,remark:n,bgColor:r,value:s}=t;return h("span.ssml-wrap",{...x},[h(`span.tag.bg-color.${r}`,[h("span.tag-remark",{attrs:{"data-tag-remark":n}}),h(`span#${e}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill"))]),h(`span.boundary.start.ft-color.${r}`),h("span",s),h(`span.boundary.end.ft-color.${r}`)])}function rr(t,e){const{bgColor:n,domId:r,remark:s}=t;return h("span.ssml-wrap",[h(`span.tag.bg-color.${n}`,{...x},[h("span.tag-remark",{attrs:{"data-tag-remark":s}}),h(`span#${r}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill",null))]),h(`span.boundary.start.ft-color.${n}`,{...x}),h("span",e),h(`span.boundary.end.ft-color.${n}`,{...x})])}function or(t){const{bgColor:e,domId:n,remark:r}=t;return h("span.ssml-wrap",[h(`span.tag.bg-color.${e}`,{...x},[h(`span#${n}-play.btn.btn-text`,h("span.iconfont.icon-play",null)),h("span.tag-remark",{attrs:{"data-tag-remark":r}}),h(`span#${n}-close.btn.btn-text`,h("span.iconfont.icon-roundclosefill",null))])])}const sr=[{type:"ssml-p",renderElem:Qn},{type:"ssml-w",renderElem:Yn},{type:"ssml-say-as",renderElem:er},{type:"ssml-break",renderElem:tr},{type:"ssml-sub",renderElem:nr},{type:"ssml-prosody",renderElem:rr},{type:"ssml-audio",renderElem:or}];function Ur(t){return t}function ir(t,e){return`<s>${e}</s>`}function ar(t,e){const{phoneme:n,value:r}=t;return n?`<w phoneme="${n}">${r}</w>`:`<w>${e}</w>`}function lr(t){const{word:e,phoneme:n}=t;return`<p ph="${n}">${e}</p>`}function ur(t,e){const{interpretAs:n}=t;return`<say-as interpret-as="${n}">${e}</say-as>`}function cr(t){const{time:e}=t;return`<break time="${e}" />`}function fr(t){const{alias:e,value:n}=t;return`<sub alias="${e}">${n}</sub>`}function dr(t,e){const{rate:n}=t;return`<prosody rate="${n}">${e}</prosody>`}function pr(t){const{src:e}=t;return`<audio src="${e}" />`}const mr=[{type:"paragraph",elemToHtml:ir},{type:"ssml-w",elemToHtml:ar},{type:"ssml-p",elemToHtml:lr},{type:"ssml-say-as",elemToHtml:ur},{type:"ssml-break",elemToHtml:cr},{type:"ssml-sub",elemToHtml:fr},{type:"ssml-prosody",elemToHtml:dr},{type:"ssml-audio",elemToHtml:pr}];function hr(t,e){return{type:"paragraph",children:e}}function gr(t,e){const n=t.getAttribute("phoneme");return n?{type:"ssml-w",phoneme:n,value:t.textContent,children:[{text:t.textContent||""}]}:{type:"ssml-w",children:e}}const br=[{selector:"s",parseElemHtml:hr},{selector:"w",parseElemHtml:gr}];function k(t,e){return t===e}function yr(t){const{isInline:e,isVoid:n,deleteBackward:r,deleteForward:s,insertBreak:i,getHtml:a,apply:d}=t,f=t;f.isInline=u=>{const c=p.DomEditor.getNodeType(u);return k(c,"ssml-w")||k(c,"ssml-p")||k(c,"ssml-break")||k(c,"ssml-say-as")||k(c,"ssml-sub")||k(c,"ssml-prosody")||k(c,"ssml-audio")?!0:e(u)},f.isVoid=u=>{const c=p.DomEditor.getNodeType(u);if(k(c,"ssml-w")){const{phoneme:m}=u;return!!m}return k(c,"ssml-p")||k(c,"ssml-break")?!0:k(c,"ssml-say-as")?!1:k(c,"ssml-sub")?!0:k(c,"ssml-prosody")?!1:k(c,"ssml-audio")?!0:n(u)},f.deleteBackward=u=>{r(u)},f.deleteForward=u=>{s(u)},f.insertBreak=()=>{i()};const l={voice:"",volume:"",pitch:""};return t.on("updateSpeak",u=>{Object.assign(l,u)}),t.on("updateBgm",u=>{l.bgm=u.value,l.bgmRemark=u.label}),t.on("removeBgm",()=>{l.bgm=void 0,l.bgmRemark=void 0}),f.getHtml=()=>{const u=[];for(const c in l)if(Object.prototype.hasOwnProperty.call(l,c)){const m=l[c];m&&u.push(`${c}=${m}`)}return`<speak ${u.join(" ")}>${a()}</speak>`},f.apply=u=>{d(u)},f}const qr="",vr={editorPlugin:yr,renderElems:sr,elemsToHtml:mr,parseElemsHtml:br},zr="",wr={install(t){t.use(Lt),t.use(Jn)}};g.AliasMenu=Re,g.BarButton=C,g.BarInput=j,g.BarPopover=ee,g.BarSearch=R,g.BarWrapper=ae,g.BarWrapperGroup=ue,g.BarWrapperItem=le,g.BgmMenu=ze,g.ChangespeedMenu=We,g.ContinuousMenu=Ae,g.DOMComment=hn,g.DOMElement=gn,g.DOMNode=mn,g.DOMRange=yn,g.DOMSelection=vn,g.DOMStaticRange=wn,g.DOMText=bn,g.DigitalMenu=je,g.EditorCoreModule=vr,g.EnglishMenu=Pe,g.MuteMenu=qe,g.ReadMenu=Fe,g.RhythmMenu=$e,g.SpeakerMenu=Le,g.SpecialMenu=Ue,g.TopPanel=ie,g.default=wr,g.genRandomStr=D,g.playSound=He,Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
